<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body style="background: #000; color: white; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; font-family: sans-serif;">
    <div id="loader">üêæ –í—Ö–æ–¥ –≤ PETGroom...</div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();

        function route() {
            const urlParams = new URLSearchParams(window.location.search);
            const masterFromUrl = urlParams.get('master');
            const startParam = tg.initDataUnsafe.start_param;
            const userId = tg.initDataUnsafe.user?.id;

            // 1. –ï—Å–ª–∏ –≤ —Å—Å—ã–ª–∫–µ —É–∂–µ –µ—Å—Ç—å ID –∏–ª–∏ –æ–Ω –ø—Ä–∏—à–µ–ª —á–µ—Ä–µ–∑ startapp (—ç—Ç–æ –ö–õ–ò–ï–ù–¢)
            const mId = masterFromUrl || startParam;

            if (mId) {
                console.log("–ú–∞—Ä—à—Ä—É—Ç: –ö–ª–∏–µ–Ω—Ç -> –ú–∞—Å—Ç–µ—Ä", mId);
                window.location.replace(`client.html?master=${mId}`);
            }
            // 2. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ—Ç (—ç—Ç–æ –ú–ê–°–¢–ï–†, –∑–∞—à–µ–¥—à–∏–π —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –±–æ—Ç–∞)
            else if (userId) {
                console.log("–ú–∞—Ä—à—Ä—É—Ç: –ú–∞—Å—Ç–µ—Ä/–ê–¥–º–∏–Ω", userId);
                window.location.replace(`admin.html?master=${userId}`);
            }
            else {
                document.getElementById('loader').innerText = "–û—à–∏–±–∫–∞: ID –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞.";
            }
        }

        // –î–∞–µ–º Telegram 250–º—Å –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
        setTimeout(route, 250);
    </script>
</body>
</html>